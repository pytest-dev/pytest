Initial restructuring of internals to support threaded execution (:issue:`13768`).
