[tox]
requires =
    tox>=4
    tox-uv>=1
isolated_build = True
distshare = {homedir}/.tox/uv-distshare
envlist =
    py310

[testenv]
description =
    run the tests
    under `{basepython}`
uv_resolution = lowest-direct
uv_python_preference = only-managed
commands =
    {env:_PYTEST_TOX_COVERAGE_RUN:} pytest {posargs:{env:_PYTEST_TOX_DEFAULT_POSARGS:}} --maxfail=1 --pdb
passenv =
    PYTEST_ADDOPTS
    TERM
    SETUPTOOLS_SCM_PRETEND_VERSION_FOR_PYTEST
    CI
setenv =
    _PYTEST_TOX_DEFAULT_POSARGS={env:_PYTEST_TOX_POSARGS_DOCTESTING:} {env:_PYTEST_TOX_POSARGS_LSOF:} {env:_PYTEST_TOX_POSARGS_XDIST:} {env:_PYTEST_FILES:}

extras = dev
deps =
    {env:_PYTEST_TOX_EXTRA_DEP:}
